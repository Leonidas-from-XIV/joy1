#
#  Makefile for JOY
#
cmake_minimum_required(VERSION 2.8.9)
project(Joy)

set(GC_BDW ON)
set(BIT_32 OFF)

set(CMAKE_EXE_LINKER_FLAGS "-Wl,--stack,0x10000000")

if(GC_BDW)
  add_definitions(-DGC_BDW -pthread)
endif()

add_definitions(-O3 -Wall -Wextra -Werror)

if(BIT_32)
  add_definitions(-DBIT_32 -ansi -pedantic)
else()
  add_definitions(-Wno-format)
endif()

add_executable(joy interp.c scan.c utils.c main.c)

if(GC_BDW)
  add_library(gc STATIC IMPORTED)
  set_target_properties(gc PROPERTIES IMPORTED_LOCATION gc/libgcmt-lib.a)
  target_link_libraries(joy gc)
endif()
